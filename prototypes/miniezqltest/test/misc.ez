temp_readings = stream of { room_id:int, temperature:int };;





h = temp_readings.groupby(:room_id, fun g -> g.last().temperature[2.sec])
                 .select (fun r -> r.max());;



when (temp_readings, fun _ -> print (h));;


#! temp_readings
timestamp, room_id, temperature
2,               1,      25
4,               3,      45  # Out-of-order keys (1, 3, 2 instead of 1, 2, 3)
5,               1,      25  # Retain the previous value
6,               2,      50
7,               3,      30
9,               1,      23