temp_readings = stream (:room_id, :temperature);;
entries = stream(:room_id, :product_id);;

entity Room =
  createFrom(temp_readings, :room_id)
  hasMany :products;;


entity Product =
  createFrom (entries, :product_id)
  belongsTo :room;;


roomsPerProducts = Room.all.select (r -> r.products)
                           .select (products -> products.select (p -> p));;

when (entries, ev -> print (roomsPerProducts));;
when (entries, ev -> print ("\n"));;


#! temp_readings
Timestamp, room_id, temperature
1,               1,      25
2,               2,      50


#! entries
Timestamp, room_id, product_id
4,               1,          2
6,               2,          2

