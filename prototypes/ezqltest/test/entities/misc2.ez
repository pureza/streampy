seg_speed_str = stream (:vehicle_id, :speed, :segment_id);;

define justNow(x:bool) : bool = x[1 sec][0];;

entity Segment =
   createFrom(seg_speed_str, :segment_id)
   hasMany :vehicles;;


entity Vehicle =
  createFrom(seg_speed_str, :vehicle_id)
  belongsTo :segment

  member self.blahBad = self.segment.speed[1 sec]

  member self.blah = {self.segment}.speed[1 sec]

  member self.blahGood = Segment.all.select (fun s -> s.speed[1 sec])[self.segment_id];;



when (seg_speed_str, fun _ -> print (Vehicle.all));;


#! seg_speed_str
timestamp, vehicle_id, speed, segment_id
1,                 10,    10,          1
3,                 10,    90,          2





