temp_readings = stream (:temperature, :room_id);;

temps_3secs = temp_readings[3 sec];;

eventsPerRoomf = { { a = g } for g in temps_3secs group by :room_id };;
eventsPerRoomh = { x.a.where(fun ev -> ev.temperature != 23).min(:temperature) for x in eventsPerRoomf };;


#! temp_readings
Timestamp, room_id, temperature
2,               1,      25
4,               3,      45  # Out-of-order keys (1, 3, 2 instead of 1, 2, 3)
5,               1,      25  # Retain the previous value
6,               2,      50
7,               3,      30
9,               1,      23