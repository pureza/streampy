temp_readings = stream (:room_id, :temperature);;

lastTemp = temp_readings.last(:temperature);;

/*
a = let g = fun (n:int) -> n * 2 in
    let f = fun (n:int) -> n * 3 in
    (if lastTemp > 30 then g else f)(lastTemp);;
*/


a = let f = fun (n:int) -> n + lastTemp in
    let g = fun (x:int) -> f(x) in
    g (lastTemp);;



when (a.updated(), fun ev -> print(a));;


#! temp_readings
Timestamp, room_id, temperature
2,               1,      25
4,               3,      45  # Out-of-order keys (1, 3, 2 instead of 1, 2, 3)
5,               1,      25  # Retain the previous value
6,               2,      50
7,               3,      30
9,               1,      23