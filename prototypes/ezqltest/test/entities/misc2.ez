temp_readings = stream (:room_id, :temperature);;

test_init = temp_readings.groupby(:room_id, fun g -> g.last(:temperature)[3 sec]);;

z = test_init.select (fun r -> r.max());;

when (z.updated(), fun _ -> print (now()); print (z));;


#! temp_readings
Timestamp, room_id, temperature
2,               1,      25
4,               3,      45
5,               1,      25
6,               2,      50
7,               3,      30
9,               1,      23
